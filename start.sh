#!/bin/bash
# Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð° Ñ– Ð±Ð¾Ñ‚Ð° Ð¾Ð´Ð½Ð¾Ñ‡Ð°ÑÐ½Ð¾

echo "ðŸš€ Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð° Ñ‚Ð° Ð±Ð¾Ñ‚Ð°..."

# Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ð¸ Ð±Ð¾Ñ‚Ð° Ñƒ Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð¼Ñƒ Ñ€ÐµÐ¶Ð¸Ð¼Ñ–
echo "ðŸ“± Ð—Ð°Ð¿ÑƒÑÐº Telegram Ð±Ð¾Ñ‚Ð°..."
node bot.js > /tmp/bot.log 2>&1 &
BOT_PID=$!
echo "âœ… Ð‘Ð¾Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¾ (PID: $BOT_PID)"

# ÐÐµÐ²ÐµÐ»Ð¸ÐºÐ° Ð·Ð°Ñ‚Ñ€Ð¸Ð¼ÐºÐ° Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð¼ ÑÐµÑ€Ð²ÐµÑ€Ð°
sleep 2

# Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ð¸ ÑÐµÑ€Ð²ÐµÑ€ (Ð¾ÑÐ½Ð¾Ð²Ð½Ð¸Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑ)
echo "ðŸŒ Ð—Ð°Ð¿ÑƒÑÐº ÑÐµÑ€Ð²ÐµÑ€Ð°..."
node server.js
SERVER_EXIT=$?

# Ð¯ÐºÑ‰Ð¾ ÑÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ð²ÑÑ, Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚Ð¸ Ð±Ð¾Ñ‚Ð°
if [ $SERVER_EXIT -ne 0 ]; then
    echo "âŒ Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ð²ÑÑ Ð· Ð¿Ð¾Ð¼Ð¸Ð»ÐºÐ¾ÑŽ, Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ Ð±Ð¾Ñ‚Ð°..."
    kill $BOT_PID 2>/dev/null
    exit $SERVER_EXIT
fi

